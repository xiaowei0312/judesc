(function(f,a,b){function e(c,g){this.element=c;this.settings=f.extend({},d,g);this._defaults=d;this._name="selectlist";this.init()}var d={selectId:null,selectBoxId:null,enable:!0,zIndex:null,width:null,height:null,border:null,borderRadius:null,showMaxHeight:null,optionHeight:34,triangleSize:6,triangleColor:"#333",topPosition:!1,speed:100,onChange:function(){}};e.prototype={init:function(){var c=this.element;this.replaceProtoypeSelect(c);this.setSelectEvent(c);this.setSelectStyle(c)},getSelectID:function(c){c=f(c).attr("id");"undefined"===typeof c&&(c="");return c},getSelectName:function(c){c=f(c);var g=c.attr("name");return"undefined"!==typeof g?g:this.getSelectID(c)},getSelectClassName:function(c){var g=[],h=[],g=f(c).attr("class");if("undefined"!==typeof g){h=g.split(" ");h.sort();g=[h[0]];for(c=1;c<h.length;c++){h[c]!==g[g.length-1]&&g.push(h[c])}return g.join(" ")}return""},getSelectedIndex:function(c){return f(c).get(0).selectedIndex||0},getOptionCount:function(c){return f(c).children().length},getOptionText:function(c){var g=f(c);c=g.children();for(var i=[],g=this.getOptionCount(g),h=0;h<g;h++){i[h]=f.trim(c.eq(h).text())}return i},getSelectedOptionText:function(c){c=f(c);var g=this.getSelectedIndex(c);return this.getOptionText(c)[g]},getSelectedOptionValue:function(c){c=f(c);var g=this.getSelectedIndex(c);return this.getOptionValue(c)[g]},getOptionValue:function(c){var g=f(c);c=g.children();for(var i=[],g=this.getOptionCount(g),h=0;h<g;h++){i[h]=c.eq(h).val()}return i},renderSelect:function(u){var v=f(u);u=this.getSelectID(v);var t=this.getSelectName(v),s=this.getSelectClassName(v),j=this.getOptionText(v),r=this.getSelectedOptionText(v),o=this.getOptionValue(v),p=this.getSelectedIndex(v),q=this.getSelectedOptionValue(v),v=this.getOptionCount(v),c="";this.settings.selectBoxId=u+"_DIV";this.settings.selectId=u;for(var i=0;i<v;i++){c=i!==p?c+'<li data-value="'+o[i]+'">'+j[i]+"</li>":c+'<li data-value="'+o[i]+'" class="selected">'+j[i]+"</li>"}return u='<div id="'+u+'_DIV" class="select-wrapper '+s+'"><input style="display:none;" type="text" id = "'+u+'"name="'+t+'" value="'+q+'" /><i class="icon select-down"></i><input type="button" class="select-button" value="'+r+'" /><div class="select-list"><ul id="'+u+'_UL">'+c+"</ul></div></div>"},reload:function(q,r,p,o){var c="",n="---\u8bf7\u9009\u62e9---",i="#"+this.settings.selectId+"_UL",j=o?"":'<li data-value="" class="selected">---\u8bf7\u9009\u62e9---</li>';if(q){for(var m=0;m<q.length;m++){0==m&&o?(j=j+'<li data-value="'+q[m][r]+'" class="selected">'+q[m][p]+"</li>",c=q[m][r],n=q[m][p]):j=j+'<li data-value="'+q[m][r]+'">'+q[m][p]+"</li>"}}f(i).html(j);f(i).parent().prev().val(n).siblings('input[type="text"]').val(c);this.setSelectEvent(this);this.setSelectStyle(this)},replaceProtoypeSelect:function(c){c=f(c);var g=this.renderSelect(c),h="#"+this.settings.selectId;c.replaceWith(g);f(h).data("selectlist",this)},setSelectDisabled:function(c){f("#"+this.settings.selectBoxId).children("i").addClass("disabled").end().children(".select-button").attr("disabled","disabled");this.settings.enable=!1},setSelectEnabled:function(c){f("#"+this.settings.selectBoxId).children("i").removeClass("disabled").end().children(".select-button").removeAttr("disabled");this.settings.enable=!0},setSelectStyle:function(c){var g=this;c=f(c);var i="#"+g.settings.selectBoxId,h=g.getOptionCount(c);f(i).css({"z-index":g.setStyleProperty(g.settings.zIndex),width:g.setStyleProperty(g.settings.width)-2+"px",height:g.setStyleProperty(g.settings.height)+"px"});f(i).children(".select-down").css({top:g.setStyleProperty((g.settings.height-g.settings.triangleSize)/2)+"px","border-width":g.setStyleProperty(g.settings.triangleSize)+"px","border-color":g.setStyleProperty(g.settings.triangleColor)+" transparent transparent transparent"});f(i).children(".select-button").css({width:function(){if(g.settings.width){return g.settings.width-2+"px"}},height:g.setStyleProperty(g.settings.height)+"px",border:g.setStyleProperty(g.settings.border),"border-radius":g.setStyleProperty(g.settings.borderRadius)+"px"});f(i).children(".select-list").css({width:function(){if(g.settings.width){return g.settings.width-2+"px"}},top:function(j,k){if(g.settings.height){if(!g.settings.topPosition){return g.settings.height+1+"px"}if(g.settings.optionHeight){return -g.settings.optionHeight*h-3+"px"}}},"max-height":g.setStyleProperty(g.settings.showMaxHeight)+"px"});f(i+" ul").css({"max-height":g.setStyleProperty(g.settings.showMaxHeight)+"px","line-height":g.setStyleProperty(g.settings.optionHeight)+"px"});f(i+" li").css({height:g.setStyleProperty(g.settings.optionHeight)+"px"})},setStyleProperty:function(c){if(c){return c}},setSelectEvent:function(c){var i=this,p=f(c),o=i.settings.speed,g=i.settings.border;c="#"+i.settings.selectBoxId;var n=i.getSelectedIndex(p),j=i.getOptionCount(p),m=f(c+' input[type="button"]'),p=f(c+" li");f(c).off("click").on("click",function(h){i.settings.enable&&(h.stopPropagation(),f(this).children(".select-list").slideToggle(o),i.settings.border?f(this).css({border:g}):f(this).addClass("focus"),f(this).find("li").each(function(){f(this).text()===m.val()&&f(this).addClass("selected").siblings().removeClass("selected")}))}).off("focusin").on("focusin",'input[type="button"]',function(){f(".select-wrapper").children(".select-list").slideUp(o);f(".select-wrapper").hasClass("focus")&&f(".select-wrapper").removeClass("focus")}).off("keyup").on("keyup",'input[type="button"]',function(h){var k=f(this).siblings(".select-list").children().children("li.selected");switch(h.keyCode){case 13:f(this).val(k.text()).prev().prev().val(k.attr("data-value"));f.isFunction(i.settings.onChange)&&i.settings.onChange.call(i);break;case 27:f(this).siblings(".select-list").slideUp(o);break;case 38:h.preventDefault();0!==n?(k.removeClass("selected").prev().addClass("selected"),--n):($selectItem.last().addClass("selected").siblings().removeClass("selected"),n=j-1);k=f(this).siblings(".select-list").children().children("li.selected");f(this).val(k.text()).prev().prev().val(k.attr("data-value"));break;case 40:h.preventDefault(),n<j-1?(k.removeClass("selected").next().addClass("selected"),n+=1):($selectItem.first().addClass("selected").siblings().removeClass("selected"),n=0),k=f(this).siblings(".select-list").children().children("li.selected"),f(this).val(k.text()).prev().prev().val(k.attr("data-value"))}}).children("i").removeClass("disabled").end().children(".select-button").removeAttr("disabled");p.off("click").on("click",function(h){var l=f.trim(f(this).attr("data-value")),k=f.trim(f(this).text());h.stopPropagation();f(this).addClass("selected").siblings().removeClass("selected");f(this).parent().parent().slideUp(o).prev().val(k).siblings('input[type="text"]').val(l);f(".select-wrapper").hasClass("focus")&&f(".select-wrapper").removeClass("focus");f.isFunction(i.settings.onChange)&&i.settings.onChange.call(i,l,k);return !1}).hover(function(){f(this).addClass("selected").siblings().removeClass("selected")}).mouseenter(function(k){k=k.target;var h=k.offsetWidth,q=k.scrollWidth,l=f(k).text();h<q&&f(k).attr("title",l)});f(b).off("click").on("click",function(){f(this).find(".select-list").slideUp(o);f(".select-wrapper").hasClass("focus")&&f(".select-wrapper").removeClass("focus")});i.settings.enable||f(c).children("i").addClass("disabled").end().children(".select-button").attr("disabled","disabled")}};f.fn.selectlist=function(c){this.each(function(){f.data(this,"selectlist")||(f.data(this,"selectlist",new e(this,c)),c.topPosition?c.zIndex++:c.zIndex--)});return this}})(jQuery,window,document);